<?php

declare(strict_types=1);

namespace {{securityNamespace}};

use Symfony\Component\HttpFoundation\Request;

/**
 * {{interfaceName}}
 *
 * Security interface for {{schemeName}} authentication scheme.
 * Type: {{schemeType}}
{{#schemeDescription}}
 *
 * {{schemeDescription}}
{{/schemeDescription}}
 *
 * Implement this interface in your application to provide authentication logic.
 * Bind your implementation in services.yaml.
 *
 * @generated
 */
interface {{interfaceName}}
{
{{#isBasicAuth}}
    /**
     * Validate HTTP Basic authentication credentials.
     *
     * @param string $username The username from Authorization header
     * @param string $password The password from Authorization header
     * @return bool True if credentials are valid
     */
    public function validateCredentials(string $username, string $password): bool;

    /**
     * Get the authenticated user identifier.
     *
     * @param string $username The username from Authorization header
     * @return string|null The user identifier or null if not authenticated
     */
    public function getUserIdentifier(string $username): ?string;
{{/isBasicAuth}}
{{#isBearerAuth}}
    /**
     * Validate Bearer token.
     *
     * @param string $token The Bearer token from Authorization header
     * @return bool True if token is valid
     */
    public function validateToken(string $token): bool;

    /**
     * Get the authenticated user identifier from token.
     *
     * @param string $token The Bearer token
     * @return string|null The user identifier or null if not authenticated
     */
    public function getUserIdentifier(string $token): ?string;
{{/isBearerAuth}}
{{#isApiKey}}
    /**
     * Validate API key.
     *
     * API Key Name: {{apiKeyName}}
     * API Key Location: {{apiKeyIn}}
     *
     * @param string $apiKey The API key value
     * @return bool True if API key is valid
     */
    public function validateApiKey(string $apiKey): bool;

    /**
     * Get the authenticated user identifier from API key.
     *
     * @param string $apiKey The API key
     * @return string|null The user identifier or null if not authenticated
     */
    public function getUserIdentifier(string $apiKey): ?string;
{{/isApiKey}}
{{#isOAuth2}}
    /**
     * Validate OAuth2 access token.
     *
     * Flows: {{#flows}}{{.}}{{^-last}}, {{/-last}}{{/flows}}
     *
     * @param string $accessToken The OAuth2 access token
     * @param array<string> $requiredScopes The scopes required for this operation
     * @return bool True if token is valid and has required scopes
     */
    public function validateToken(string $accessToken, array $requiredScopes = []): bool;

    /**
     * Get the authenticated user identifier from access token.
     *
     * @param string $accessToken The OAuth2 access token
     * @return string|null The user identifier or null if not authenticated
     */
    public function getUserIdentifier(string $accessToken): ?string;

    /**
     * Get the scopes associated with the access token.
     *
     * @param string $accessToken The OAuth2 access token
     * @return array<string> The scopes
     */
    public function getTokenScopes(string $accessToken): array;
{{/isOAuth2}}

    /**
     * Extract authentication credentials from the request.
     *
     * @param Request $request The incoming HTTP request
     * @return string|null The credentials or null if not present
     */
    public function extractCredentials(Request $request): ?string;
}
