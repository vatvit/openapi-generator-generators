<?php declare(strict_types=1);

namespace {{apiPackage}}\Security;

use Closure;
use Illuminate\Http\Request;

/**
 * {{interfaceName}}
 *
 * Auto-generated security interface from OpenAPI security scheme: {{schemeName}}
 *
 * DEVELOPER MUST implement this interface in their authentication middleware
 * The library validates that middleware implementing this interface is attached to protected routes
 *
 * OpenAPI Security Scheme:
 * - Type: {{schemeType}}
{{#schemeDescription}}
 * - Description: {{schemeDescription}}
{{/schemeDescription}}
{{#isHttp}}
 * - Scheme: {{httpScheme}}
{{#bearerFormat}}
 * - Bearer Format: {{bearerFormat}}
{{/bearerFormat}}
{{/isHttp}}
{{#isApiKey}}
 * - In: {{apiKeyIn}}
 * - Name: {{apiKeyName}}
{{/isApiKey}}
{{#isOAuth2}}
 * - OAuth2 Flow (see OpenAPI spec for details)
{{/isOAuth2}}
 *
 * PSR-4 COMPLIANT: One interface per security scheme
 */
interface {{interfaceName}}
{
    /**
     * Handle an incoming request
     *
     * This method MUST:
{{#isHttp}}
{{#isBearerAuth}}
     * - Extract Bearer token from Authorization header
     * - Validate the token (JWT signature, expiration, etc.)
{{/isBearerAuth}}
{{#isBasicAuth}}
     * - Extract Basic auth credentials from Authorization header
     * - Validate username and password
{{/isBasicAuth}}
{{/isHttp}}
{{#isApiKey}}
     * - Extract API key from {{apiKeyIn}}: {{apiKeyName}}
     * - Validate the API key
{{/isApiKey}}
{{#isOAuth2}}
     * - Extract OAuth2 access token from Authorization header
     * - Validate the token and required scopes
{{/isOAuth2}}
     * - Return 401 response if authentication fails
     * - Call $next($request) if authentication succeeds
     *
     * @param Request $request
     * @param Closure $next
     * @return mixed
     */
    public function handle(Request $request, Closure $next);
}
